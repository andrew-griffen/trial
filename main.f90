some fortran code
fixed a bug
